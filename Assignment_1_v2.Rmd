---
title: "Multivariate Assignment - 1 v1"
author: "Elena Ortega - Damiano Alessi - Xieru Song - Aharon V. Zúñiga."
date: "October - 2020"
output:
  html_document:
    toc: yes
    toc_float: yes
  word_document:
    toc: yes
editor_options:
  chunk_output_type: console
chunk_output_type: console
---


```{r setup, include=FALSE}

library(maptools)
library(dplyr)
library(Matrix.utils)
library(ggplot2)
library(lavaan)
library(candisc)
library(semTools)
library(semPlot)
library(knitr)
library(tables)
knitr::opts_chunk$set(echo = TRUE)

```

# [Descriptive & Basis analysis] 

### Descriptive & Basis analysis   

Data from wvs.R file contain 33 variables and 32684 observations. All of them are numeric with exception of country variable that is a factor.
 
```{r step_1}
options(scipen=999)
print("a")
load("wvs.Rdata")
str(wvs)
zscore <- function(x) {
  zscore <- (x-mean(x))/sd(x)
} 

```


# Damiano

```{r step_damiano }

#Exploratory factor analysis (EFA)
#load("C:/Users/damia/Desktop/lavoro multivariate statistics/wvs.Rdata")

#standardize data
zwvs<-as.data.frame(scale(wvs[,16:29]),center=TRUE,scale=TRUE)

#run PCA
pcawvs<-prcomp(zwvs)

#screeplot
screeplot(pcawvs,type="lines")
abline(a=0, b=1, h=1, v=0)



#analysis 3-factor model with no rotation
fact3<-factanal(~J_claiming_benefits+J_avoiding_fare+J_stealing_property+J_cheating_taxes+J_accept_bribe+J_homosexuality
+J_prostitution+J_abortion+J_divorce+J_sex_before_marriage+J_suicide+J_beat_wife+J_parents_beating_children
+J_violence,factors=3,method="mle",rotatio="none",data=zwvs)

print(fact3,cutoff=0)

#compute communalities
round(1-fact3$uniqueness,2)

#print loadings
print(fact3$loadings,cutoff=0,digits=2)

#compute residual corr
cormat<-cor(zwvs)
resid3<-cormat-(crossprod(t(fact3$loadings))+diag(fact3$uniquenesses))

#compute number of residual correlations with absolute value larger than 0.05 below the diagonal
n3<-sum(ifelse(abs(resid3)>0.05,1,0))/2

#compute proportion of residual correlations with absolute value larger than 0.05 below the diagonal
print(n3/(14*13/2))



#analysis 3-factor model with varimax rotation
fact3vm<-factanal(~J_claiming_benefits+J_avoiding_fare+J_stealing_property+J_cheating_taxes+J_accept_bribe+J_homosexuality+
J_prostitution+J_abortion+J_divorce+J_sex_before_marriage+J_suicide+J_beat_wife
+J_parents_beating_children+J_violence,factors=3,method="mle",rotatio="varimax",data=zwvs)
print(fact3vm,cutoff=0)

#compute communalities
round(1-fact3vm$uniqueness,2)

#print loadings
print(fact3vm$loadings,cutoff=0,digits=2)


#compute residual corr
cormat<-cor(zwvs)
resid3vm<-cormat-(crossprod(t(fact3vm$loadings))+diag(fact3vm$uniquenesses))

#compute number of residual correlations with absolute value larger than 0.05 below the diagonal
n3vm<-sum(ifelse(abs(resid3vm)>0.05,1,0))/2

#compute proportion of residual correlations with absolute value larger than 0.05 below the diagonal
print(n3vm/(14*13/2))



library(psych)
library(GPArotation)

#extract 3 factors and use oblique rotation
fact3obl<-fa(zwvs,3,rotate="oblimin",fm="mle")
print(fact3obl,cutoff=0)

# residual correlation
resid3obl<-cor(zwvs)-(fact3obl$loadings%*%fact3obl$Phi%*%t(fact3obl$loadings)+diag(fact3obl$uniquenesses))

#compute proportion of residual correlations with absolute value larger than 0.05 below the diagonal
n3obl<-sum(ifelse(abs(resid3obl)>0.05,1,0))/2

print(n3obl/(14*13/2))



#save score
score<-cbind(wvs[33],fact3obl$scores)


## distribution Factor 1 per country
par(pty="s")
par(las=1,cex=0.5) 
par(oma=c(2,6,2,2)) 
boxplot(score$ML1~score$country,horizontal=TRUE,xlab="factor score",ylab="",main="Financial")

par(pty="s")
par(las=1,cex=0.5) 
par(oma=c(2,6,2,2))
boxplot(score$ML2~score$country,horizontal=TRUE,xlab="factor score",ylab="",main="Interpersonal")

par(pty="s")
par(las=1,cex=0.5) 
par(oma=c(2,6,2,2))
boxplot(score$ML3~score$country,horizontal=TRUE,xlab="factor score",ylab="",main="Violencial")


```

# 4. [Structural equation model (SEM)] 
### Structural equation model (SEM)  

Continue working on the data of the countries “Netherlands” and “Malaysia”. 
Estimate a structural equation model to investigate how the importance of religion affects the justifiability of behaviors for respondents.
Does the result of the analysis differ for respondents of the two countries?

After filtering the countries Netherlands and Malaysia from the data, a structural equation model was conducted.   

```{r p4_step_0}
#Filter data by country
raw_country <- wvs[wvs$country %in% c("Netherlands","Malaysia"),]

```

Firstly, a model with 3 latent variables verified from the previous analysis ( **Interpersonal**,**Financial**, **Violence**) was used as measurement model of justifiability behaviours, a fourth latent variable called **religious belief** which one used the following manifest variables __R_attend_religious_services__, __R_pray__ and __R_importance_God__.


```{r p4_step_1}

#In order to make the model identifiable, loadings for the first manifest variables of each factor are constraint to 1, in that way variances of factors are estimated freely.
#Additionally, we include three regressions in order to understand how the latent variable religious interact with the other latent variables.

         #Violence =~ J_suicide  it was not included as the relation with the latent variable is low see std.lv 0.229
         #Violence =~ J_prostitution it was not be included as the relation with the latent variable is low see std.lv 0.157

sem1<- ' Interpersonal =~ 1*J_homosexuality+J_prostitution+J_abortion+J_divorce+J_sex_before_marriage+J_suicide
         Financial     =~ 1*J_claiming_benefits+J_avoiding_fare+J_stealing_property+J_cheating_taxes+J_accept_bribe
         Violence      =~ 1*J_beat_wife+ J_parents_beating_children+J_violence
         Financial     ~~ Violence
          Financial ~~ J_suicide
          Violence ~~ J_suicide
          Violence ~~ J_prostitution
          J_homosexuality ~~ J_sex_before_marriage
         Religious     =~ 1*R_attend_religious_services + R_pray + R_importance_God
         Interpersonal ~ Religious 
         Financial     ~ Religious 
         Violence      ~ Religious '

##Financial     ~~ Violence afirmo correlacion entre 2 latentes(*)
##Interpersonal ~ Religious  regresion

cfa2<-'Financial =~1*J_claiming_benefits+J_avoiding_fare+J_stealing_property+J_cheating_taxes+J_accept_bribe
       Interpersonal =~1*J_homosexuality+J_prostitution+J_abortion+J_divorce+J_sex_before_marriage+J_suicide
       Violence =~1*J_beat_wife+J_parents_beating_children+J_violence
       Financial ~~Violence
       Financial ~~J_suicide
       Violence ~~J_suicide
       Violence ~~J_prostitution
       J_homosexuality ~~J_sex_before_marriage';

#varianzas a 1 
#primer componente Idenfificadad 

```

In order to attend the model needed, is necessary to select the variables to use

```{r p4_step_2}

#Creating vectors to use as a columns
Interpersonal <- c("J_homosexuality","J_prostitution","J_abortion","J_divorce","J_sex_before_marriage","J_suicide")
Financial <- c("J_claiming_benefits","J_avoiding_fare","J_stealing_property","J_cheating_taxes","J_accept_bribe")
Violence  <- c("J_beat_wife", "J_parents_beating_children","J_violence")
Religious <- c("R_attend_religious_services" , "R_pray" , "R_importance_God")


#Create dataframe with standardized variables 
raw_data <- apply(raw_country[,c(Interpersonal, Financial, Violence, Religious)],2,zscore)
#Joining country to standardized data and bulk it into a new dataframe "raw_data_c"
raw_data_c <- cbind(data.frame(raw_data),country = raw_country$country)

```

 When we use the data of both countries in the Structural Equation Model, the __CFI is 0.961__ and __TLI is 0.953__; both values are __greater than 0.95__, which means that the model has a good fit. Then __RMSEA__ obtained a __value of 0.070__, which means that is a good fit as well, because it is __lower than 0.08__.

```{r p4_step_3}

#Fit Structural Equation Models, using as a parameter sem1 and filtering data. Is not using a covariance matrix because it will be use a country as a column.
fitsem1<-lavaan::sem(sem1, data = raw_data_c)

#check goodness of fit
fitmeasures(fitsem1, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea", "srmr"))

```

 With those result we can conclude that this model is reliable for analysis, this means that not only that the latent variables can be created usign the manifest variables but also that the regression model has a good fit. Now, we will review the result for regression analysis.
 
 Accordingly to the previous analysis, the manifest variables has high estimates for each corresponding latent variable, with standardized values from 0.687 the lowest and 0.921 the highest. SAme results are obtained for the new latent variable religious, with standardized values going from 0.81 to 0.911.  

Accordingly to the regression results, the latent variable __religious__ has a P-value __lower than 0.05__ for the three regressions, this means that there is enough evidence __to reject the null hypothesis__ that the estimate is __0__. With this, can be concluded that the religious variable has an impact into Interpersonal, Financial and Violence justifiability behaviours variables. In addition, is possible to say for two variables this impact is positive, however, for the other variable, (Interpersonal) is the opposite. This can mean that higher the level of religious in a person, lower the justification of behaviours regarding Interpersonal relations. Contrary, higher the level of religiousness higher the justification of behaviours regarding Financial and Violence conflicts. 

```{r p4_step_4}

#install.packages("stargazer")
#library(stargazer)
summary(fitsem1, standardized=TRUE)
lavaan::standardizedSolution(fitsem1)


#semPaths(fitsem1,"model","std","lisrel", edge.label.cex = 1.2, intercepts = FALSE, layout = "tree2",
#panelGroups = FALSE, ask = FALSE, groups = "latent", pastel = TRUE, exoCov = TRUE, rotation = 1)


semPaths(fitsem1, "std", edge.label.cex = 0.5, curvePivot = TRUE, groups = "latent", pastel = TRUE, rotation = 2)


title("SEM path Diagram                       ")
text(-0.4,-.99999,"Netherlands & Malaysia")

```

## Comparison : Netherland & Malaysia


To see if this relationship is maintained applying the same analysis for each country in a separate way, we will use the same model for each country  separately. The results are the followings.


### Netherland


For Netherlands, __the goodness of fit index CFI and TLI are not higher than critical values__, but __RMSEA__ is in acceptable level. __Chi-square test is also significant__.

```{r p4_step_5}

#Firstly, filter data of Netherlands
fitsem_n <- lavaan::sem(sem1,data = raw_data_c[raw_data_c$country %in% c("Netherlands"),])
#Secondly, analyse summary
fitmeasures(fitsem_n, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea", "srmr"))


```

Results for regressions indicate that __2 of the 3 regression are not significant__ at 0.05 level, this means that the relation between __religious and financial and violence behaviour is not significant__. Only religion has an impact in __Interpersonal Justification__ behavior, with negative value as in the global model. 

```{r p4_step_6}
summary(fitsem_n, standardized=TRUE)

#semPaths(fitsem_n,"model","std","lisrel", edge.label.cex = 1.2, intercepts = FALSE, layout = "tree2",
#panelGroups = FALSE, ask = FALSE, groups = "latent", pastel = TRUE, exoCov = TRUE, rotation = 1)
#title("Netherlands")
semPaths(fitsem_n, "std", edge.label.cex = 0.5, curvePivot = TRUE, groups = "latent", pastel = TRUE, rotation = 2)


title("SEM path Diagram                       ")
text(-0.4,-.99999,"Netherlands")

```

### Malaysia

```{r p4_step_7}

#Firstly, filter data 
fitsem_m <- lavaan::sem(sem1, data = raw_data_c[raw_data_c$country %in% c("Malaysia"),])
fitmeasures(fitsem_m, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea", "srmr"))

```
Here. in the Malaysia data, the goodness of fit index __CFI and TLI are not higher than critical values__, and __RMSEA it is in the same form__. __Chi-square test is significant__. This means that the measurement model doesn't have a good fit in this data.  

Even thought the manifest variables do not show higher relations with each latent variables, the results for the regressions indicate __that 3 of the 3 regression are significant__, but all of them has a negative impact in the dependant variable, this means that the __relation between religious and financial, violence and Interpersonal behavior is nehgatively related__.  


```{r p4_step_8}
summary(fitsem_m, standardized=TRUE)

semPaths(fitsem_m,"model","std","lisrel", edge.label.cex = 1.2, intercepts = FALSE, layout = "tree2",
panelGroups = FALSE, ask = FALSE, groups = "latent", pastel = TRUE, exoCov = TRUE, rotation = 1)
title("Malaysia")

#semPaths(fitsem_n,"model","std","lisrel", edge.label.cex = 1.2, intercepts = FALSE, layout = "tree2",
#panelGroups = FALSE, ask = FALSE, groups = "latent", pastel = TRUE, exoCov = TRUE, rotation = 1)
#title("Netherlands")
semPaths(fitsem_m, "std", edge.label.cex = 0.5, curvePivot = TRUE, groups = "latent", pastel = TRUE, rotation = 2)


title("SEM path Diagram                       ")
text(-0.4,-.99999,"Malaysia")

```

### Conclusion

Comparing the results in the global model with both countries, a positive relation between religion with financial and violence. 
In the case of Interpersonal issues, a negative association was found. This change dramatically when analysing the data separately for each country, where in Malaysia all the relationships are negative this means higher the religious lower the justification behaviour regarding financial and violence issues.



# 5. [Canonical Correlation Analysis] 

### Canonical correlation analysis  

Conduct a canonical correlation analysis to investigate the relations between the following two sets of variables: 
  * Set of X variables: 3 items about importance of religion __(see Table 4)__ and 5 items about occurrence of crimes in the neighborhood __(see Table 2)__.  
  * Set of Y variables: 14 items about the justifiability of behaviors __(see Table 3)__.

Conduct the analysis on standardized items using the data of the countries “Netherlands” and “Malaysia”.

```{r 5step_1}

#Creating both sets of variables  
set_x <- c("R_attend_religious_services","R_pray","R_importance_God", "CR_robberies", "CR_alcohol", "CR_police_military", "CR_racist_behavior", "CR_drug_sale")
  
set_y <- c("J_claiming_benefits", "J_avoiding_fare", "J_stealing_property", "J_cheating_taxes", "J_accept_bribe", "J_homosexuality", "J_prostitution", "J_abortion", "J_divorce", "J_sex_before_marriage", "J_suicide", "J_beat_wife", "J_parents_beating_children", "J_violence")

ds2 <- wvs[wvs$country %in% c("Netherlands","Malaysia"),c(set_x, set_y, "country")]

#conduct canonical correlation analysis
cancor.out12 <- cancor(x = ds2[,set_x], y = ds2[,set_y], xcenter = TRUE, ycenter = TRUE) 
summary(cancor.out12)
cancor.out12$structure$X.xscores
cancor.out12$structure$X

cancor.out12$structure$Y.yscores

cancor.out12$structure$X.yscores
cancor.out12$structure$Y.xscores
plot(cancor.out12)

Xcan12 <- cancor.out12$scores$X[,1]
Ycan12 <- cancor.out12$scores$Y[,1]
XY <- data.frame(Xcan12, Ycan12, country = ds2$country)

#geom_point(data = XY, aes(color = country))

ggplot(XY, aes(x= Xcan12, y= Ycan12)) +
  scale_fill_distiller() +
  geom_point(aes(color = country)) +
labs(title = "Canonical Correspondence Analysis") +
  xlab("u1") +
  ylab("t1") 

print(redundancy(cancor.out12))

#str(ds)
```
 

# Netherlands
 
```{r 5step_Netherland}

#Creating both sets of variables  

dsN <- wvs[wvs$country %in% c("Netherlands"),c(set_x, set_y, "country")]

#conduct canonical correlation analysis
cancor.out1N <- cancor(x = dsN[,set_x], y = dsN[,set_y], xcenter = TRUE, ycenter = TRUE) 
summary(cancor.out1N)
cancor.out1N$structure$X.xscores

cancor.out1N$structure$Y.yscores

cancor.out1N$structure$X.yscores
cancor.out1N$structure$Y.xscores

Xcan1N <- cancor.out1N$scores$X[,1]
Ycan1N <- cancor.out1N$scores$Y[,1]
XYN <- data.frame(Xcan1N, Ycan1N, country = dsN$country)

#geom_point(data = XY, aes(color = country))

ggplot(XYN, aes(x= Xcan1N, y= Ycan1N)) +
    scale_fill_distiller() +
  geom_point(aes(color = country)) +
labs(title = "Canonical Correspondence Analysis")+
  xlab("u1") +
  ylab("t1") 

print(redundancy(cancor.out1N))

#str(ds)
``` 

# Malaysia

```{r 5step_Malaysia}

#Creating both sets of variables  

dsM <- wvs[wvs$country %in% c("Malaysia"),c(set_x, set_y, "country")]

#conduct canonical correlation analysis
cancor.out1M <- cancor(x = dsM[,set_x], y = dsM[,set_y], xcenter = TRUE, ycenter = TRUE) 
summary(cancor.out1M)
cancor.out1M$structure$X.xscores

cancor.out1M$structure$Y.yscores

cancor.out1M$structure$X.yscores
cancor.out1M$structure$Y.xscores

Xcan1M <- cancor.out1M$scores$X[,1]
Ycan1M <- cancor.out1M$scores$Y[,1]
XY <- data.frame(Xcan1M, Ycan1M, country = dsM$country)

#geom_point(data = XY, aes(color = country))

ggplot(XY, aes(x= Xcan1M, y= Ycan1M)) +
  scale_fill_distiller() +
  geom_point(aes(color = country)) +
labs(title = "Canonical Correspondence Analysis") +
  xlab("u1") +
  ylab("t1") 


print(redundancy(cancor.out1M))
#str(ds)
``` 

 
```{r 5step_2}
#conduct canonical correlation analysis
# cancor.out12 <- cancor(x = ds2[,set_x], y = ds2[,set_y], xcenter = TRUE, ycenter = TRUE) 
# summary(cancor.out12)
# cancor.out1$structure$X.xscores
# cancor.out1$structure$X
# 
# cancor.out1$structure$Y.yscores
# 
# cancor.out1$structure$X.yscores
# cancor.out1$structure$Y.xscores
# plot(cancor.out1)
# 
# Xcan1 <- cancor.out1$scores$X[,1]
# Ycan1 <- cancor.out1$scores$Y[,1]
# XY <- data.frame(Xcan1, Ycan1, country = ds$country)
# 
# #geom_point(data = XY, aes(color = country))
# 
# ggplot(XY, aes(x= Xcan1, y= Ycan1)) +
#   scale_color_brewer(palette="Paired") +
#   geom_point(aes(color = country)) +
# labs(title = "Canonical Correspondence Analysis")
#+
#  stat_ellipse()
#library(tidyverse)

#ccavectors <- as.matrix(scores(cancor.out1)) %>% 
#  as.data.frame()

#species_data <- scores(cancor.out1, display = "country") %>% 
#  as.data.frame()
  
#plot_cca <- ggplot(XY) +
#  geom_point(aes(x = Xcan1, y = Ycan1, color = country), shape = 19, size = 2, alpha = 0.8) +
#  coord_fixed() +
  #scale_color_manual(values = pal) +
#  geom_segment(data = species_data, aes(x = 0, y = 0, xend = Xcan1, yend = Ycan1), arrow = arrow(length = unit(0.2, "cm"))) +
#  geom_vline(xintercept = c(0), color = "grey70", linetype = 2) +
#  geom_hline(yintercept = c(0), color = "grey70", linetype = 2) +
#  geom_point(data = XY, aes(x = Xcan1, y = Ycan1), shape = 17, size = 2, color = "slateblue") +
#  scale_x_continuous(limits = c(-1.5, 1.5)) +
#  scale_y_continuous(limits = c(-2, 2)) +
#  geom_text(data = ccavectors, aes(x = Xcan1, y = Ycan1, label = rownames(ccavectors)), nudge_x = 0.3, nudge_y = 0.3) +
#clean_background +
  #labs(title = "Canonical Correspondence Analysis")
#plot_cca
  

```

**1. How many canonical correlations are significant?**  
 
The **H0 test** indicate that the __first five canonical__ correlations are significant because, __Pr(>F)__ is lower than significance level of __'0.05' (5%)__. This result shows that __H0 : "The canonical correlations in the current row and all that follow are zero"__ can be rejected.

**2. How can you interpret the canonical variates?**  

For the current analysis there are 5 significant canonical correlations, however, three of them explain the higher amount of variance. For that reason, the first three are selected to be interpreted.
  
__CC1 ->__ Is represented by religious beliefs on x variables and interpersonal matters on the y variables.
  Less religiosity more justification in sexual behaviour (such as homosexuality,prostitution, abortion, divorce, sex before marriage.)

 
**3. How much variance in the Y variables can be explained by the X variables?**  

By using just the first canonical correlation __92.84477__ percent of the variance can be explained, this is clear as the eigenvalue for this correlation is higher than 1.

```{r 5step_x}

#redundancy(cancor.out1))

#print(redundancy(cancor.out1))


```

```{r 5step_x1}

#split data in two parts and standardize data
# train<-ds[seq(2,nrow(ds),by=2),]
# valid<-ds[seq(1,nrow(ds),by=2),]
# train[,2:11]<-scale(train[,2:11],center=TRUE,scale=TRUE)
# valid[,2:11]<-scale(valid[,2:11],center=TRUE,scale=TRUE)
# 
# #conduct CCA on calibration data
# cancor.train<-cancor(cbind(J_claiming_benefits, J_avoiding_fare, J_stealing_property, J_cheating_taxes, J_accept_bribe, J_homosexuality, J_prostitution, J_abortion, J_divorce, J_sex_before_marriage, J_suicide, J_beat_wife, J_parents_beating_children, J_violence)
# ~R_attend_religious_services + R_pray + R_importance_God + CR_robberies + CR_alcohol + CR_police_military + CR_racist_behavior + CR_drug_sale,data=train)
# summary(cancor.train)
# cancor.train$structure$X.xscores
# cancor.train$structure$Y.yscores
# 
# #conduct CCA on validation data
# cancor.valid<-cancor(cbind(J_claiming_benefits, J_avoiding_fare, J_stealing_property, J_cheating_taxes, J_accept_bribe, J_homosexuality, J_prostitution, J_abortion, J_divorce, J_sex_before_marriage, J_suicide, J_beat_wife, J_parents_beating_children, J_violence)
# ~ R_attend_religious_services + R_pray + R_importance_God + CR_robberies + CR_alcohol + CR_police_military + CR_racist_behavior + CR_drug_sale,data=valid)
# summary(cancor.valid)
# cancor.valid$structure$X.xscores
# cancor.valid$structure$Y.yscores
# 
# 
# # canonical variates calibration set
# train.X1<-cancor.train$score$X
# train.Y1<-cancor.train$score$Y

# compute canonical variates using data of calibration set and coefficients estimated on validation set
#train.X2<-as.matrix(train[,2:6])%*%cancor.valid$coef$X
#train.Y2<-as.matrix(train[,7:11])%*%cancor.valid$coef$Y



#R(T,T*) and R(U,U*)
#round(cor(train.Y1,train.Y2)[1:3,1:3],3)
#round(cor(train.X1,train.X2)[1:3,1:3],3)
#R(U*,T*) versus R(U,T)
#round(cor(train.X1,train.Y1)[1:3,1:3],3)
#round(cor(train.X2,train.Y2)[1:3,1:3],3)
#R(T*,T*) and R(U*,U*)
#round(cor(train.Y2,train.Y2)[1:3,1:3],3)
#round(cor(train.X2,train.X2)[1:3,1:3],3)


```


# [Annexes] 

## Codebook

### Table 1

| Column | Variable | Item |
|-|:--|:--------|
| 1 | V_creative | It is important to this person to think up new ideas and be creative; to do things one’s own way. |
| 2 | V_rich | It is important to this person to be rich; to have a lot of money and expensive things. |
| 3 | V_secure | Living in secure surroundings is important to this person; to avoid anything that might be dangerous. |
| 4 | V_spoil_oneself | It is important to this person to have a good time;to “spoil” oneself. |
| 5 | V_do_good | It is important to this person to do something for the good of |
| 6 | V_be_successful | Being very successful is important to this person; to have people recognize one’s achievements. |
| 7 | V_exciting_life | Adventure and taking risks are important to this person; to have an exciting life. |
| 8 | V_behave_properly | It is important to this person to always behave properly; to avoid doing anything people would say is wrong. |
| 9 | V_protect_environment | Looking after the environment is important to this person; to care for nature and save life resources. |
| 10 | V_tradition | Tradition is important to this person; to follow the customs handed down by one’s religion or family |

### Table 2

| Column | Variable | Item |
|-|:--|:--------|
| 11 | CR_robberies | Robberies |
| 12 | CR_alcohol | Alcohol consumption in the streets |
| 13 | CR_police_military | Police or military interfere with people’s private life |
| 14 | CR_racist_behavior | Racist behavior |
| 15 | CR_drug_sale | Drug sale in streets |

### Table 3

| Column | Variable | Item |
|-|:--|:--------|
| 16 | J_claiming_benefits | Claiming government benefits to which you are not entitled |
| 17 | J_avoiding_fare | Avoiding a fare on public transport |
| 18 | J_stealing_property | Stealing property |
| 19 | J_cheating_taxes | Cheating on taxes if you have a chance |
| 20 | J_accept_bribe | Someone accepting a bribe in the course of their duties |
| 21 | J_homosexuality | Homosexuality |
| 22 | J_prostitution | Prostitution |
| 23 | J_abortion | Abortion |
| 24 | J_divorce | Divorce |
| 25 | J_sex_before_marriage | Sex before marriage |
| 26 | J_suicide | Suicide |
| 27 | J_beat_wife | For a man to beat his wife |
| 28 | J_parents_beating_children | Parents beating children |
| 29 | J_violence | Violence against other people |


### Table 4

| Column | Variable | Item |
|-|:--|:--------|
| 30 | R_attend_religious_services | Apart from weddings and funerals, about how often do you attend religious services these days? 1=never, practically never,…,7=more than once a week |
| 31 | R_pray | Apart from weddings and funerals, about how often do you pray? 1=never, practically never,…,8=more than once a week |
| 32 | R_importance_God | How important is God in your life? 1=not at all important, …, 10=very important |



## Libraries

* [maptools](https://cran.r-project.org/web/packages/maptools/index.html) - maptools 
* [dplyr](https://cran.r-project.org/web/packages/dplyr/index.html) - dplyr
* [Matrix.utils](https://cran.r-project.org/web/packages/Matrix.utils/index.html) -  Matrix.utils
* [ggplot2](https://cran.r-project.org/web/packages/ggplot2/index.html) -  ggplot2 
* [lavaan](https://cran.r-project.org/web/packages/lavaan/lavaan.pdf) - lavaan
* [candisc](https://cran.r-project.org/web/packages/candisc/index.html) - candisc
* [semTools](https://cran.r-project.org/web/packages/semTools/index.html) - semTools
* [semPlot](https://cran.r-project.org/web/packages/semPlot/semPlot.pdf) - semPlot
* [knitr](https://cran.r-project.org/web/packages/knitr/index.html) - knitr
* [tables](https://cran.r-project.org/web/packages/tables/vignettes/tables.pdf) - tables

